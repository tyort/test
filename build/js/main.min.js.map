{"version":3,"sources":["source/js/formulas.js","source/js/drag-n-drop.js","source/js/main.js"],"names":["renderComponent","container","element","place","prepend","after","append","createElement","template","newElement","document","innerHTML","dropArea","querySelector","movingEvents","previewFile","file","reader","FileReader","readAsDataURL","onloadend","img","src","result","getElementById","appendChild","console","log","forEach","eventName","addEventListener","evt","preventDefault","stopPropagation","index","classList","toggle","dataTransfer","files","body","pageLink","photoGallery","target","value","method","url","itemData","fetch","JSON","stringify","headers","Content-Type","then","response","ok","json","error","e","Error","data","sendRequest","stringOfPhotos","createPhotos","galleryImages","add","turnOnListener","catch","err","children","photo","photoContainer","createPhotoContainer","outerHTML","firstChild","style","width","dataset","height","onPhotoClick","photos","map","item","join","className","count","parentElement","find","remove","removeEventListener"],"mappings":"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","file":"main.min.js","sourcesContent":["export const renderComponent = (container, element, place) => {\n  switch (place) {\n    case `afterBegin`:\n      container.prepend(element);\n      break;\n    case `afterEnd`:\n      container.after(element);\n      break;\n    default:\n      container.append(element);\n  }\n};\n\nexport const createElement = (template) => {\n  const newElement = document.createElement(`div`);\n  newElement.innerHTML = template;\n  return newElement;\n};\n\nexport const onEscKeyDown = (evt) => {\n  if (evt.key === `Escape` || evt.key === `Esc`) {\n    hideElement();\n  }\n};\n\nexport const hideElement = () => {\n  const requestPopup = document.querySelector(`.page-request-popup`);\n  const successPopup = document.querySelector(`.page-success-popup`);\n\n  successPopup.classList.toggle(`visually-hidden`, true);\n  requestPopup.classList.toggle(`visually-hidden`, true);\n  document.removeEventListener(`keydown`, onEscKeyDown);\n  document.querySelector(`body`).style.overflow = `visible`;\n};\n\nexport const phoneSample = /^((8|\\+7)[\\- ]?)?(\\(?\\d{3}\\)?[\\- ]?)?[\\d\\- ]{7,10}$/;\nexport const nameSample = /^[a-zA-Zа-яёА-ЯЁ]+$/u;\n\nexport function sendRequest(method, url, itemData = null) {\n  const headers = {\n    'Content-Type': 'application/json'\n  }\n\n  return fetch(url, {\n    method: method,\n    itemData: JSON.stringify(itemData),\n    headers: headers\n  })\n    .then(response => {\n      if (response.ok) {\n        return response.json()\n      }\n\n      return response.json()\n        .then(error => {\n          const e = new Error('Что-то пошло не так')\n          e.data = error\n          throw e\n        })\n    })\n}\n","const dropArea = document.querySelector(`#drop-area`);\r\nconst movingEvents = [`dragenter`, `dragover`, `dragleave`, `drop`];\r\nconsole.log(dropArea)\r\n\r\nmovingEvents.forEach((eventName) => {\r\n  dropArea.addEventListener(eventName, (evt) => {\r\n    evt.preventDefault()\r\n    evt.stopPropagation()\r\n  })\r\n})\r\n\r\nmovingEvents.forEach((eventName, index) => {\r\n  if (index <= 1) {\r\n    dropArea.addEventListener(eventName, () => dropArea.classList.toggle('highlight', true));\r\n  } else {\r\n    dropArea.addEventListener(eventName, () => dropArea.classList.toggle('highlight', false));\r\n  }\r\n})\r\n\r\ndropArea.addEventListener(`drop`, (evt) => {\r\n  let dt = evt.dataTransfer; // Объект DataTransfer используется для хранения данных, перетаскиваемых мышью во время операции drag and drop\r\n  let files = [...dt.files]; // список файлов с характеристиками\r\n  files.forEach(previewFile)\r\n})\r\n\r\nfunction previewFile(file) {\r\n  let reader = new FileReader()\r\n  reader.readAsDataURL(file)\r\n  reader.onloadend = function() {\r\n    let img = document.createElement(`img`)\r\n    img.src = reader.result\r\n    document.getElementById(`gallery`).appendChild(img)\r\n  }\r\n}","const body = document.querySelector(`body`);\nconst pageLink = document.querySelector(`.page-link`);\nconst photoGallery = document.querySelector(`.photo-gallery`);\n\nimport {sendRequest, renderComponent, createElement} from './formulas';\nimport './drag-n-drop';\n\npageLink.querySelector(`form`).addEventListener(`submit`, (evt) => {\n  evt.preventDefault();\n  const requestURL = evt.target.querySelector(`#link-phone`).value\n\n  sendRequest('GET', `https://don16obqbay2c.cloudfront.net/frontend-test-task/gallery-images.json`)\n    .then(data => {\n      const stringOfPhotos = createPhotos(data.galleryImages);\n      renderComponent(photoGallery, createElement(stringOfPhotos), `afterBegin`);\n      photoGallery.querySelector(`div`).classList.add(`photo-gallery__inner`);\n      turnOnListener();\n    })\n    .catch(err => console.log(err))\n});\n\nconst turnOnListener = () => {\n  const photoGalleryInner = photoGallery.querySelector(`.photo-gallery__inner`);\n  const photolist = [...photoGalleryInner.children];\n\n  photolist.forEach((photo) => {\n    photo.addEventListener(`click`, () => {\n      let photoContainer = createElement(createPhotoContainer(photo.outerHTML)).firstChild;\n      renderComponent(body, photoContainer, `afterBegin`);\n\n      photoContainer = document.querySelector(`.photo-container`)\n      photoContainer.querySelector(`img`).style.width = `${photo.dataset.width}px`;\n      photoContainer.querySelector(`img`).style.height = `${photo.dataset.height}px`;\n      photoContainer.addEventListener(`click`, (evt) => onPhotoClick(evt))\n    })\n  })\n}\n\nconst createPhotos = (photos) => {\n  return photos\n    .map((item, index) => {\n      return (\n        `<img \n          src=\"${item.url}\"\n          data-width=\"${item.width}\"\n          data-height=\"${item.height}\"\n          data-count=\"${index}\"\n          alt=\"\"\n        >`\n      );\n    })\n    .join(``);\n};\n\nconst createPhotoContainer = (photo) => {\n  return (\n    `<div class=\"photo-container\">\n      ${photo}\n      <button class=\"button-wide\">Удалить фото</button>\n    </div>`\n  )\n}\n\nconst onPhotoClick = (evt) => {\n  const photoContainer = document.querySelector(`.photo-container`);\n\n  if (evt.target.className === `button-wide`) {\n    const count = evt.target.parentElement.querySelector(`img`).dataset.count;\n    const allPhotos = [...document.querySelector(`.photo-gallery__inner`).children];\n    const unwantedPhoto = allPhotos.find((photo) => photo.dataset.count === count);\n    unwantedPhoto.remove();\n  }\n\n  photoContainer.removeEventListener(`click`, onPhotoClick);\n  photoContainer.remove();\n}\n\n\n\n\n\n"]}